/* assets/chattia-ui.css
   OPS Online Support — Chattia UI (v2)
   - UI layout + components (theme colors come from assets/chattia-theme.css variables)
   - Transcript drawer (right-to-left)
   - Privacy/Consent modal
   - FABs: Contact / Join Us / Chatbot
   - Subtle “watermark” moving background (45s cycle)
*/

/* -------------------- Base / Reset -------------------- */

* { box-sizing: border-box; }
html, body { height: 100%; }
:root {
  --page-left-offset: 65px;
}
body {
  margin: 0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  color: var(--fg);
  background: var(--bg);
}

body.chatbot-only {
  display: flex;
  min-height: 100vh;
}

body.chatbot-only .chat-drawer {
  position: relative;
  width: 100%;
  max-width: 980px;
  height: auto;
  min-height: 100vh;
  margin: 0 auto;
  border-left: none;
  border-right: none;
  box-shadow: none;
  transform: none;
}

body.chatbot-only .chat-drawer.is-open {
  transform: none;
}

body.chatbot-only #chatClose {
  display: none;
}

a { color: inherit; text-decoration: none; }
a:focus, button:focus, input:focus, textarea:focus {
  outline: 2px solid var(--focus);
  outline-offset: 2px;
}

.sr-only {
  position: absolute !important;
  width: 1px !important;
  height: 1px !important;
  padding: 0 !important;
  margin: -1px !important;
  overflow: hidden !important;
  clip: rect(0,0,0,0) !important;
  white-space: nowrap !important;
  border: 0 !important;
}

/* -------------------- App Shell -------------------- */

.app {
  min-height: 100%;
  display: grid;
  grid-template-rows: auto 1fr auto;
  position: relative;
  isolation: isolate;
}

/* Subtle “liquid” watermark background */
.app::before {
  content: "";
  position: fixed;
  inset: 0;
  z-index: -2;
  background: var(--bg);
}

.app::after {
  content: "";
  position: fixed;
  inset: -20%;
  z-index: -1;
  pointer-events: none;
  opacity: var(--wm-opacity, 0.08);
  filter: blur(22px) saturate(1.05);
  transform: translateZ(0);
  background:
    radial-gradient(60% 45% at 20% 30%, var(--wm-1) 0%, transparent 65%),
    radial-gradient(55% 40% at 70% 25%, var(--wm-2) 0%, transparent 66%),
    radial-gradient(60% 45% at 55% 75%, var(--wm-3) 0%, transparent 67%),
    radial-gradient(50% 38% at 15% 80%, var(--wm-4) 0%, transparent 68%);
  animation: wm-shift 45s ease-in-out infinite;
}

@keyframes wm-shift {
  0%   { transform: translate(-2%, -1%) scale(1.02); opacity: var(--wm-opacity, 0.08); }
  25%  { transform: translate(2%, -2%) scale(1.05); opacity: calc(var(--wm-opacity, 0.08) + 0.02); }
  50%  { transform: translate(3%, 2%)  scale(1.03); opacity: var(--wm-opacity, 0.08); }
  75%  { transform: translate(-1%, 3%) scale(1.06); opacity: calc(var(--wm-opacity, 0.08) + 0.01); }
  100% { transform: translate(-2%, -1%) scale(1.02); opacity: var(--wm-opacity, 0.08); }
}

/* -------------------- Topbar / Nav -------------------- */

.topbar {
  display: flex;
  align-items: center;
  justify-content: flex-end;
  gap: 12px;
  padding: 12px 16px;
  border-bottom: 1px solid var(--line);
  background: color-mix(in srgb, var(--panel) 92%, transparent);
  backdrop-filter: blur(10px);
}

.topbar .nav-actions {
  margin-left: auto;
}

@media (min-width: 980px) {
  .topbar {
    max-width: 1100px;
    margin: 0 auto;
    width: 100%;
    padding-left: calc(16px + var(--page-left-offset));
  }
}

.brand {
  display: flex;
  align-items: center;
  gap: 10px;
  min-width: 0;
}

.brand-mark {
  width: 34px;
  height: 34px;
  border-radius: 10px;
  background: var(--accent);
  box-shadow: 0 8px 30px color-mix(in srgb, var(--accent) 30%, transparent);
  display: grid;
  place-items: center;
  font-weight: 800;
  color: var(--accent-contrast);
  letter-spacing: 0.02em;
}

.brand-text {
  display: flex;
  flex-direction: column;
  min-width: 0;
}
.brand-title {
  font-weight: 700;
  line-height: 1.1;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.brand-subtitle {
  font-size: 12px;
  color: var(--muted);
  line-height: 1.2;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.nav {
  display: flex;
  align-items: center;
  gap: 10px;
  flex-wrap: wrap;
  justify-content: flex-end;
}

.nav a, .nav button {
  appearance: none;
  border: 1px solid var(--line);
  background: var(--chip);
  color: var(--fg);
  padding: 8px 10px;
  border-radius: 10px;
  font-size: 13px;
  cursor: pointer;
  transition: transform .06s ease, background .2s ease, border-color .2s ease;
}

.nav a:hover, .nav button:hover {
  border-color: color-mix(in srgb, var(--line) 40%, var(--fg));
  background: color-mix(in srgb, var(--chip) 80%, var(--panel));
}

.nav a:active, .nav button:active {
  transform: translateY(1px);
}

.nav .nav-primary {
  display: flex;
  align-items: center;
  gap: 10px;
}

.nav .nav-actions {
  display: flex;
  align-items: center;
  gap: 10px;
}

.toggle {
  display: inline-flex;
  align-items: center;
  gap: 8px;
}
.toggle .dot {
  width: 34px;
  height: 20px;
  border-radius: 999px;
  background: var(--toggle-track);
  border: 1px solid var(--line);
  position: relative;
}
.toggle .dot::after {
  content: "";
  width: 16px;
  height: 16px;
  border-radius: 50%;
  position: absolute;
  top: 50%;
  left: 2px;
  transform: translateY(-50%);
  background: var(--toggle-knob);
  transition: left .2s ease;
}
.toggle.is-on .dot::after { left: 16px; }

/* -------------------- Main Layout -------------------- */

.main {
  display: grid;
  grid-template-columns: 1fr;
  gap: 12px;
  padding: 14px 16px 90px;
}

@media (min-width: 980px) {
  .main {
    padding: 18px 20px 90px;
    max-width: 1100px;
    margin: 0 auto;
    width: 100%;
    padding-left: calc(20px + var(--page-left-offset));
  }
}

.card {
  background: var(--panel);
  border: 1px solid var(--line);
  border-radius: 16px;
  box-shadow: 0 10px 35px color-mix(in srgb, #000 12%, transparent);
}

.inline-ctas {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  margin-top: 12px;
}

/* -------------------- Chat -------------------- */

.chat {
  display: grid;
  grid-template-rows: auto 1fr auto;
  min-height: 60vh;
}

.chat-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
  padding: 12px 14px;
  border-bottom: 1px solid var(--line);
}

.chat-title {
  display: flex;
  flex-direction: column;
  gap: 4px;
  font-weight: 700;
  margin: 0;
  font-size: 14px;
  color: var(--fg);
}

.chat-subtitle {
  font-weight: 500;
  font-size: 12px;
  color: var(--muted);
  line-height: 1.4;
  max-width: 260px;
}

.chat-header-actions {
  display: flex;
  align-items: center;
  gap: 10px;
  align-self: flex-start;
  margin-top: 2px;
}

.chat-header-toggles {
  display: inline-flex;
  align-items: center;
  gap: 6px;
}

.chat-meta {
  font-size: 12px;
  color: var(--muted);
  display: flex;
  align-items: center;
  gap: 10px;
}

.chat-actions {
  display: flex;
  align-items: center;
  gap: 8px;
}

.chat-actions .btn {
  padding: 6px 10px;
  font-size: 12px;
}

.chat-hero {
  padding: 12px 14px 0;
}

.chat-hero img {
  width: 100%;
  height: auto;
  border-radius: 18px;
  border: 1px solid var(--line);
  background: var(--panel);
  display: block;
}

.chat-intro {
  margin: 0;
  padding: 12px 14px;
  border-bottom: 1px dashed var(--line);
  font-size: 13px;
  color: var(--muted);
}

.pill {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 6px 10px;
  border: 1px solid var(--line);
  background: var(--chip);
  border-radius: 999px;
}

.messages {
  padding: 14px;
  overflow: auto;
  max-height: 62vh;
  scroll-behavior: smooth;
}

.msg {
  display: grid;
  grid-template-columns: 1fr;
  margin: 0 0 12px;
}

.bubble {
  max-width: min(720px, 100%);
  padding: 10px 12px;
  border-radius: 14px;
  border: 1px solid var(--line);
  background: var(--bubble);
  color: var(--fg);
  line-height: 1.35;
  font-size: 14px;
  white-space: pre-wrap;
  word-break: break-word;
}

.msg.user { justify-items: end; }
.msg.user .bubble {
  background: var(--bubble-user);
  border-color: color-mix(in srgb, var(--accent) 35%, var(--line));
}

.msg.assistant { justify-items: start; }
.msg.assistant .bubble {
  background: var(--bubble-assistant);
}

.msg .stamp {
  margin-top: 6px;
  font-size: 11px;
  color: var(--muted);
  padding: 0 4px;
}

.composer {
  display: grid;
  grid-template-columns: 1fr auto;
  gap: 10px;
  padding: 12px 12px;
  border-top: 1px solid var(--line);
}

.composer textarea {
  width: 100%;
  min-height: 44px;
  max-height: 120px;
  resize: vertical;
  padding: 10px 12px;
  border-radius: 12px;
  border: 1px solid var(--line);
  background: var(--input);
  color: var(--fg);
  font-size: 14px;
}

.btn {
  appearance: none;
  border: 1px solid var(--line);
  background: var(--chip);
  color: var(--fg);
  padding: 10px 12px;
  border-radius: 12px;
  cursor: pointer;
  font-weight: 600;
  transition: transform .06s ease, background .2s ease, border-color .2s ease;
}

.btn:hover {
  border-color: color-mix(in srgb, var(--line) 40%, var(--fg));
  background: color-mix(in srgb, var(--chip) 80%, var(--panel));
}

.btn:active { transform: translateY(1px); }
.btn.primary {
  background: var(--accent);
  border-color: color-mix(in srgb, var(--accent) 55%, var(--line));
  color: var(--accent-contrast);
}

.btn.ghost {
  background: transparent;
}

/* -------------------- Chat Drawer (index.html) -------------------- */

.chat-drawer {
  position: fixed;
  top: 0;
  right: 0;
  height: 100%;
  width: min(420px, 100%);
  background: var(--panel);
  border-left: 1px solid var(--line);
  box-shadow: -20px 0 60px color-mix(in srgb, #000 25%, transparent);
  transform: translateX(100%);
  transition: transform .22s ease;
  z-index: 35;
  display: flex;
  flex-direction: column;
}

.chat-drawer.is-open { transform: translateX(0); }

.chat-body {
  padding: 14px;
  overflow: auto;
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.chat-input {
  display: grid;
  grid-template-columns: 1fr auto;
  grid-template-rows: auto auto;
  gap: 10px;
  padding: 12px 12px;
  border-top: 1px solid var(--line);
}

.chat-input .turnstile-slot {
  grid-column: 1 / -1;
  min-height: 0;
  opacity: 0;
  pointer-events: none;
}

.chat-input .turnstile-slot.is-visible {
  min-height: 56px;
  opacity: 1;
  pointer-events: auto;
}

.chat-input input {
  width: 100%;
  min-height: 44px;
  padding: 10px 12px;
  border-radius: 12px;
  border: 1px solid var(--line);
  background: var(--input);
  color: var(--fg);
  font-size: 14px;
}

.chat-disclaimer {
  padding: 10px 12px 14px;
  margin: 0;
  border-top: 1px dashed var(--line);
  font-size: 12px;
  color: var(--muted);
}

/* -------------------- Transcript Drawer -------------------- */

.drawer {
  position: fixed;
  top: 0;
  right: 0;
  height: 100%;
  width: min(420px, 92vw);
  background: var(--panel);
  border-left: 1px solid var(--line);
  box-shadow: -20px 0 60px color-mix(in srgb, #000 25%, transparent);
  transform: translateX(100%);
  transition: transform .22s ease;
  z-index: 30;
  display: grid;
  grid-template-rows: auto 1fr auto;
}

.drawer.is-open { transform: translateX(0); }

.drawer-header {
  padding: 12px 14px;
  border-bottom: 1px solid var(--line);
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
}

.drawer-title {
  margin: 0;
  font-weight: 700;
  font-size: 14px;
}

.drawer-body {
  padding: 12px 14px;
  overflow: auto;
  font-size: 13px;
  color: var(--fg);
}

.drawer-footer {
  padding: 12px 14px;
  border-top: 1px solid var(--line);
  display: flex;
  gap: 10px;
  justify-content: flex-end;
}

.backdrop {
  position: fixed;
  inset: 0;
  background: color-mix(in srgb, #000 45%, transparent);
  opacity: 0;
  pointer-events: none;
  transition: opacity .18s ease;
  z-index: 25;
}
.backdrop.is-on {
  opacity: 1;
  pointer-events: auto;
}

/* -------------------- Modals -------------------- */

.modal {
  position: fixed;
  inset: 0;
  display: grid;
  place-items: center;
  padding: 18px;
  z-index: 40;
  opacity: 0;
  pointer-events: none;
  transition: opacity .18s ease;
}

.modal.is-open {
  opacity: 1;
  pointer-events: auto;
}

.modal::before {
  content: "";
  position: absolute;
  inset: 0;
  background: color-mix(in srgb, #000 55%, transparent);
}

.modal-card {
  position: relative;
  width: min(640px, 92vw);
  background: var(--panel);
  border: 1px solid var(--line);
  border-radius: 16px;
  box-shadow: 0 25px 80px color-mix(in srgb, #000 35%, transparent);
  overflow: hidden;
}

.modal-head {
  padding: 12px 14px;
  border-bottom: 1px solid var(--line);
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
}

.modal-title {
  margin: 0;
  font-size: 14px;
  font-weight: 800;
}

.modal-body {
  padding: 14px;
  color: var(--fg);
  font-size: 13px;
  line-height: 1.45;
}

.transcript-textarea {
  width: 100%;
  min-height: 220px;
  margin-top: 10px;
  padding: 10px 12px;
  border-radius: 12px;
  border: 1px solid var(--line);
  background: var(--panel-alt);
  color: var(--fg);
  font-family: ui-monospace, SFMono-Regular, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  font-size: 12px;
  line-height: 1.45;
  resize: vertical;
}

.modal-actions {
  padding: 12px 14px;
  border-top: 1px solid var(--line);
  display: flex;
  justify-content: flex-end;
  gap: 10px;
}

/* -------------------- FABs -------------------- */

.fabs,
.fab-stack {
  position: fixed;
  right: 16px;
  bottom: 16px;
  display: grid;
  gap: 10px;
  z-index: 35;
}

.fab {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  padding: 12px 14px;
  border-radius: 999px;
  border: 1px solid var(--line);
  background: color-mix(in srgb, var(--panel) 85%, transparent);
  backdrop-filter: blur(10px);
  box-shadow: 0 16px 45px color-mix(in srgb, #000 22%, transparent);
  cursor: pointer;
  font-weight: 800;
  letter-spacing: .01em;
}

.fab .label { font-size: 13px; }
.fab.primary {
  background: var(--accent);
  border-color: color-mix(in srgb, var(--accent) 55%, var(--line));
  color: var(--accent-contrast);
}
.fab-accent {
  background: var(--accent);
  border-color: color-mix(in srgb, var(--accent) 55%, var(--line));
  color: var(--accent-contrast);
}

@media (max-width: 520px) {
  .fab .label { display: none; }
  .fab { padding: 12px; }
}

/* -------------------- Footer -------------------- */

.footer {
  border-top: 1px solid var(--line);
  background: color-mix(in srgb, var(--panel) 92%, transparent);
  backdrop-filter: blur(10px);
  padding: 10px 16px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
  color: var(--muted);
  font-size: 12px;
}

@media (min-width: 980px) {
  .footer {
    max-width: 1100px;
    margin: 0 auto;
    width: 100%;
    padding-left: calc(16px + var(--page-left-offset));
  }
}

.footer .left, .footer .right {
  display: flex;
  align-items: center;
  gap: 10px;
}

.footer .copyright {
  display: inline-flex;
  align-items: center;
  gap: 8px;
}

.footer .copyright .mark {
  width: 18px;
  height: 18px;
  border-radius: 6px;
  display: grid;
  place-items: center;
  border: 1px solid var(--line);
  background: var(--chip);
  color: var(--fg);
  font-weight: 900;
  font-size: 12px;
}

/* -------------------- Small utilities -------------------- */

.muted { color: var(--muted); }
.sep { width: 1px; height: 18px; background: var(--line); opacity: 0.8; }
.hidden { display: none !important; }

.hp {
  position: absolute !important;
  width: 1px !important;
  height: 1px !important;
  padding: 0 !important;
  margin: -1px !important;
  overflow: hidden !important;
  clip: rect(0, 0, 0, 0) !important;
  white-space: nowrap !important;
  border: 0 !important;
  opacity: 0 !important;
  pointer-events: none !important;
}
