<!-- index.html
     OPS Online Support ‚Äî Chat Only

     Notes:
     - No inline JS. Uses /assets/*.js
     - Chat uses gateway endpoint (set in assets/chattia-ui.js config)
     - Privacy/Consent modal required before enabling chat
     - ‚ÄúCompliance-aligned‚Äù UX: no sensitive data, no card data, no passwords/OTPs
-->

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Chattia ‚Ä¢ Chat</title>

  <!-- Basic hardening (best delivered via headers, but meta helps on static hosting) -->
  <meta name="referrer" content="no-referrer" />
  <meta http-equiv="X-Content-Type-Options" content="nosniff" />
  <meta http-equiv="X-Frame-Options" content="DENY" />

  <!-- CSP: keep strict; update connect-src to your gateway -->
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'none';
    base-uri 'none';
    object-src 'none';
    frame-ancestors 'none';
    form-action 'self';
    img-src 'self' data:;
    font-src 'self' data:;
    style-src 'self';
    script-src 'self';
    connect-src 'self' https://ops-gateway.grabem-holdem-nuts-right.workers.dev;
    frame-src 'none';
    upgrade-insecure-requests;
  " />

  <!-- OPS Gateway config for assets/chattia-ui.js -->
  <meta name="ops-gateway" content="https://ops-gateway.grabem-holdem-nuts-right.workers.dev" />
  <meta name="ops-asset-id" content="ops-online-support-site" />

  <link rel="icon" href="/assets/favicon.svg" type="image/svg+xml" />

  <!-- Theme + UI -->
  <link rel="stylesheet" href="/assets/chattia-theme.css" />
  <link rel="stylesheet" href="/assets/chattia-ui.css" />

  <!-- Language head helper (sets html[lang] early, no inline JS) -->
  <script defer src="/assets/chattia-head-lang.js"></script>
</head>

<body>
  <div class="app">
    <!-- Top bar -->
    <header class="topbar">
      <div class="brand">
        <span class="brand-dot" aria-hidden="true"></span>
        <div class="brand-text">
          <strong>OPS Online Support</strong>
          <span class="sub" data-i18n="topbar_sub">Secure Chat</span>
        </div>
      </div>

      <div class="top-actions">
        <button class="btn btn-ghost" id="themeToggle" type="button" aria-pressed="false" aria-label="Toggle theme">
          <span class="icon" aria-hidden="true">‚òæ</span>
          <span class="label" data-i18n="theme_label">Theme</span>
        </button>

        <button class="btn btn-ghost" id="langToggle" type="button" aria-pressed="false" aria-label="Toggle language">
          <span class="icon" aria-hidden="true">üåê</span>
          <span class="label" data-i18n="lang_label">EN/ES</span>
        </button>
      </div>
    </header>

    <!-- Main content -->
    <main class="main">
      <section class="hero">
        <h1 class="hero-title" data-i18n="hero_title">Chattia</h1>
        <p class="hero-desc" data-i18n="hero_desc">
          Ask about OPS services, solutions, and how we can support your operations.
        </p>

        <div class="hero-cards">
          <article class="card">
            <h3 data-i18n="card1_title">Fast answers</h3>
            <p data-i18n="card1_desc">Get clear information about OPS offerings and next steps.</p>
          </article>
          <article class="card">
            <h3 data-i18n="card2_title">Secure by design</h3>
            <p data-i18n="card2_desc">No uploads, no sensitive info, and anti-abuse protections.</p>
          </article>
          <article class="card">
            <h3 data-i18n="card3_title">Lead-ready</h3>
            <p data-i18n="card3_desc">When you‚Äôre ready, we‚Äôll route you to contact or sales.</p>
          </article>
        </div>
      </section>
    </main>

    <!-- Floating action button -->
    <button class="fab" id="fabChat" type="button" aria-label="Open chat" aria-expanded="false">
      <span class="fab-icon" aria-hidden="true">üí¨</span>
    </button>

    <!-- Privacy & Consent modal -->
    <dialog class="modal" id="consentModal" aria-labelledby="consentTitle" aria-hidden="true">
      <form method="dialog" class="modal-card">
        <div class="modal-head">
          <h2 class="modal-title" id="consentTitle" data-i18n="consent_title">Privacy & Consent</h2>
          <button class="btn btn-ghost" id="consentClose" type="button" aria-label="Close privacy and consent">‚úï</button>
        </div>

        <p class="modal-text" data-i18n="consent_body">
          Chat interactions may be used to improve the chatbot... experience. Please do not enter sensitive personal information.
          OPS Online Support does not intentionally collect payment card data, banking info, passwords, or one-time codes.
        </p>

        <div class="modal-actions">
          <button class="btn btn-secondary" id="consentDeny" value="deny" type="submit" data-i18n="consent_deny">Deny</button>
          <button class="btn btn-primary" id="consentAccept" value="accept" type="submit" data-i18n="consent_accept">Accept</button>
        </div>

        <p class="modal-footnote" data-i18n="consent_note">
          If you deny consent, chat will remain disabled until you accept.
        </p>
      </form>
    </dialog>

    <!-- Chat Panel -->
    <div class="backdrop" id="chatBackdrop" aria-hidden="true"></div>
    <aside class="chat-drawer" id="chatDrawer" aria-label="Chattia" aria-hidden="true">
      <header class="chat-header">
        <div class="chat-title">
          <strong data-i18n="chat_title">Chattia</strong>
        </div>

        <div class="chat-header-actions">
          <div class="chat-header-toggles" aria-label="Chat preferences">
            <button class="btn btn-ghost" id="langToggle" type="button" aria-pressed="false" data-i18n="chat_lang_toggle_text" aria-label="Change language">
              EN
            </button>
            <button class="btn btn-ghost" id="themeToggle" type="button" aria-pressed="false" aria-label="Change theme">
              ‚òæ
            </button>
            <button class="btn btn-ghost" id="chatTranscript" type="button" aria-label="Open transcript">
              ‚éò
            </button>
            <button class="btn btn-ghost" id="chatClear" type="button" aria-label="Clear chat">
              ‚ü≤
            </button>
          </div>

          <button class="btn btn-ghost" id="chatClose" type="button" aria-label="Close chat">‚úï</button>
        </div>
      </header>

      <div class="chat-body" id="chatBody" role="log" aria-live="polite" aria-relevant="additions"></div>

      <footer class="chat-footer">
        <form class="chat-form" id="chatForm" autocomplete="off">
          <!-- Honeypots -->
          <input class="hp" type="text" name="hp_email" id="hp_email" autocomplete="off" tabindex="-1" aria-hidden="true" hidden />
          <input class="hp" type="text" name="hp_website" id="hp_website" autocomplete="off" tabindex="-1" aria-hidden="true" hidden />

          <input class="chat-input" id="chatMessage" name="message" type="text" inputmode="text" maxlength="256"
                 placeholder="Type your message‚Ä¶" aria-label="Your message" />
          <button class="btn btn-primary" type="submit" aria-label="Send message">Send</button>
        </form>

        <div class="chat-footnote" data-i18n="chat_note">
          Please avoid sharing personal or sensitive information.
        </div>
      </footer>
    </aside>

    <!-- Transcript modal -->
    <dialog class="modal" id="transcriptModal" aria-labelledby="transcriptTitle" aria-hidden="true">
      <div class="modal-card modal-card-wide">
        <div class="modal-head">
          <h2 class="modal-title" id="transcriptTitle" data-i18n="transcript_title">Transcript</h2>
          <button class="btn btn-ghost" id="transcriptClose" type="button" aria-label="Close transcript">‚úï</button>
        </div>

        <div class="modal-body">
          <p data-i18n="transcript_body">Copy or download your chat history.</p>
          <textarea class="transcript-textarea" id="transcriptText" readonly aria-label="Chat history"></textarea>
        </div>

        <div class="modal-actions">
          <button class="btn btn-secondary" id="transcriptCopy" type="button" data-i18n="transcript_copy">Copy</button>
          <button class="btn btn-primary" id="transcriptDownload" type="button" data-i18n="transcript_download">Download</button>
        </div>
      </div>
    </dialog>

    <!-- App scripts -->
    <script defer src="/assets/chattia-preferences.js"></script>
    <script defer src="/assets/chattia-ui.js"></script>
  </div>
</body>
</html>

