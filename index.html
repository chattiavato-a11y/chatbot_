<!-- index.html
     OPS Online Support — Home + Chat Entry (v2)

     Notes:
     - No inline JS. Uses /assets/*.js
     - Chat uses gateway endpoint (set in assets/chattia-ui.js config)
     - Privacy/Consent modal required before enabling chat
     - “Compliance-aligned” UX: no sensitive data, no card data, no passwords/OTPs
-->

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>OPS Online Support</title>

  <!-- Basic hardening (best delivered via headers, but meta helps on static hosting) -->
  <meta name="referrer" content="no-referrer" />
  <meta http-equiv="X-Content-Type-Options" content="nosniff" />
  <meta http-equiv="X-Frame-Options" content="DENY" />

  <!-- CSP: keep strict; update connect-src to your gateway -->
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self';
    base-uri 'self';
    object-src 'none';
    frame-ancestors 'none';
    form-action 'self';
    img-src 'self' data:;
    font-src 'self' data:;
    style-src 'self';
    script-src 'self';
    connect-src 'self' https://ops-gateway.grabem-holdem-nuts-right.workers.dev;
    upgrade-insecure-requests;
  " />

  <!-- OPS Gateway config for assets/chattia-ui.js -->
  <meta name="ops-gateway" content="https://ops-gateway.grabem-holdem-nuts-right.workers.dev" />
  <meta name="ops-asset-id" content="ops-online-support-site" />

  <link rel="icon" href="/assets/favicon.svg" type="image/svg+xml" />

  <!-- Theme + UI -->
  <link rel="stylesheet" href="/assets/chattia-theme.css" />
  <link rel="stylesheet" href="/assets/chattia-ui.css" />

  <!-- Language head helper (sets html[lang] early, no inline JS) -->
  <script defer src="/assets/chattia-head-lang.js"></script>
</head>

<body class="chatbot-only">

  <!-- Privacy & Consent Modal (chat stays disabled until accepted) -->
  <dialog class="modal" id="consentModal" aria-labelledby="consentTitle">
    <form method="dialog" class="modal-card">
      <h2 id="consentTitle" data-i18n="consent_title">Privacy & Consent</h2>

      <p class="modal-text" data-i18n="consent_body">
        Chat interactions may be used to improve the chatbot experience. Please do not enter sensitive personal information.
        OPS Online Support does not intentionally collect payment card data, banking info, passwords, or one-time codes.
      </p>

      <div class="modal-actions">
        <button class="btn btn-secondary" id="consentDeny" value="deny" type="submit" data-i18n="consent_deny">Deny</button>
        <button class="btn btn-primary" id="consentAccept" value="accept" type="submit" data-i18n="consent_accept">Accept</button>
      </div>

      <p class="modal-footnote" data-i18n="consent_note">
        If you deny consent, chat will remain disabled until you accept.
      </p>
    </form>
  </dialog>

  <!-- Chat Panel (slides in from right) -->
  <aside class="chat-drawer" id="chatDrawer" aria-label="OPS Assistant" aria-hidden="true">
    <header class="chat-header">
      <div class="chat-title">
        <strong data-i18n="chat_title">OPS Assistant</strong>
        <span class="chat-subtitle" data-i18n="chat_subtitle">Guided CX • Lead Gen • Careers</span>
      </div>
      <div class="chat-actions">
        <button class="btn btn-ghost" id="langToggle" type="button" data-i18n="chat_lang_toggle_text" aria-label="Change language">
          EN/ES
        </button>
        <button class="btn btn-ghost" id="themeToggle" type="button" data-i18n="chat_theme_toggle_text" aria-label="Toggle theme">
          Dark/Light
        </button>
        <button class="btn btn-ghost" id="chatClose" type="button" aria-label="Close chat">✕</button>
      </div>
    </header>

    <div class="chat-hero" aria-hidden="true">
      <img src="/assets/chatbot-hero.svg" alt="" />
    </div>

    <p class="chat-intro" data-i18n="chat_intro">
      Tell us your goal, industry, volume, and timeline so we can route you to the right next step.
    </p>

    <div class="chat-body" id="chatBody" role="log" aria-live="polite" aria-relevant="additions"></div>

    <form class="chat-input" id="chatForm">
      <!-- Honeypot fields (hidden by CSS) -->
      <input class="hp" type="text" name="hp_email" id="hp_email" autocomplete="off" tabindex="-1" aria-hidden="true" />
      <input class="hp" type="text" name="hp_website" id="hp_website" autocomplete="off" tabindex="-1" aria-hidden="true" />

      <label class="sr-only" for="chatMessage" data-i18n="chat_label">Your message</label>
      <input id="chatMessage" name="message" type="text" maxlength="256" autocomplete="off"
             placeholder="Type your message…" data-i18n-placeholder="chat_placeholder" />

      <button class="btn btn-primary" type="submit" data-i18n="chat_send">Send</button>
    </form>

    <p class="chat-disclaimer" data-i18n="chat_disclaimer">
      Do not share passwords, OTP codes, banking info, or card numbers in chat. Use Contact for sensitive matters.
    </p>
  </aside>

  <!-- App scripts -->
  <script defer src="/assets/chattia-preferences.js"></script>
  <script defer src="/assets/chattia-ui.js"></script>

  <noscript>
    <div class="noscript">
      This site works best with JavaScript enabled. You can still use the Contact and Policies pages without chat.
    </div>
  </noscript>
</body>
</html>
